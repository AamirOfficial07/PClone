<div class="app-shell">
  <div
    *ngIf="toast$ | async as toast"
    class="app-toast"
    [class.app-toast--success]="toast.kind === 'success'"
    [class.app-toast--error]="toast.kind === 'error'"
    [class.app-toast--info]="toast.kind === 'info'"
  >
    <span class="app-toast__message">{{ toast.message }}</span>
    <button
      type="button"
      class="app-toast__close"
      (click)="onDismissToast()"
    >
      ✕
    </button>
  </div>

  <header class="app-header">
    <div class="app-header__brand">
      <span class="app-header__logo">SO</span>
      <span class="app-header__title">Social Orchestrator</span>
    </div>

    <div class="app-header__right">
      <nav class="app-header__nav">
        <a
          routerLink="/"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
        >
          Home
        </a>

        <a
          routerLink="/workflows"
          routerLinkActive="active"
        >
          Workflows
        </a>

        <a
          routerLink="/settings"
          routerLinkActive="active"
        >
          Settings
        </a>
      </nav>

      <ng-container *ngIf="apiState$ | async as api">
        <span
          class="app-header__api"
          [class.app-header__api--mock]="api.mode === 'mock'"
          [class.app-header__api--online]="api.mode === 'live' && api.status === 'online'"
          [class.app-header__api--offline]="api.mode === 'live' && api.status === 'offline'"
        >
          <ng-container *ngIf="api.mode === 'mock'">
            API: Mock mode
          </ng-container>
          <ng-container *ngIf="api.mode === 'live'">
            API:
            <ng-container *ngIf="api.status === 'online'">
              Live · Online
            </ng-container>
            <ng-container *ngIf="api.status === 'offline'">
              Live · Offline
            </ng-container>
            <ng-container *ngIf="api.status === 'unknown'">
              Live · Checking…
            </ng-container>
          </ng-container>
        </span>
      </ng-container>
    </div>
  </header>

  <div class="app-shell__body">
    <aside class="app-sidebar">
      <nav class="app-sidebar__nav">
        <a
          routerLink="/workflows"
          routerLinkActive="active"
        >
          Workflows
        </a>
        <a
          routerLink="/settings"
          routerLinkActive="active"
        >
          Settings
        </a>
      </nav>
    </aside>

    <main class="app-main">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>